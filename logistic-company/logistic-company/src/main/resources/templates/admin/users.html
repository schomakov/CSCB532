<!DOCTYPE html>
<html lang="bg" xmlns:th="http://www.thymeleaf.org">
<div th:insert="~{header :: head}"></div>
<body class="d-flex flex-column min-vh-100">
    <div th:replace="~{header :: header}"></div>

    <main class="container mt-4">
        <h2 class="page-title"><i class="bi bi-people"></i> Потребители</h2>

        <div class="card">
            <div class="card-header"><i class="bi bi-list-ul"></i> Списък потребители</div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead>
                        <tr>
                            <th>ID</th>
                            <th>Потребителско име</th>
                            <th>Име</th>
                            <th>Имейл</th>
                            <th>Роля</th>
                            <th class="text-end">Действия</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="user : ${users}">
                            <td th:text="${user.id}">1</td>
                            <td><strong th:text="${user.username}">username</strong></td>
                            <td th:text="${user.firstName + ' ' + user.lastName}">Име</td>
                            <td th:text="${user.email}">email@domain.com</td>
                            <td>
                                <form th:action="@{/admin/users/{id}/role(id=${user.id})}" method="post" class="d-inline-flex gap-2 align-items-center">
                                    <select name="role" class="form-select form-select-sm" style="width:auto" th:value="${user.role}">
                                        <option th:each="role : ${availableRoles}"
                                                th:value="${role}"
                                                th:selected="${role == user.role}"
                                                th:text="${role}">ROLE</option>
                                    </select>
                                    <button type="submit" class="btn btn-sm btn-outline-secondary"><i class="bi bi-check-lg me-1"></i>Запази</button>
                                </form>
                            </td>
                            <td class="text-end">
                                <form th:if="${user.role != T(com.nbu.CSCB532.model.Role).ADMINISTRATOR}"
                                      th:action="@{/admin/users/{id}/delete(id=${user.id})}" method="post" onsubmit="return confirm('Изтриване на потребител?');" class="d-inline">
                                    <button type="submit" class="btn btn-sm btn-outline-danger"><i class="bi bi-trash me-1"></i>Изтрий</button>
                                </form>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </main>

    <div th:replace="~{footer :: footer}"></div>
</body>
</html>
